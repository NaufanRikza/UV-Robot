#include <Arduino.h>

#define SIGMOID_SAMPLING 0.1

extern volatile uint16_t elapsedtime;
extern volatile uint16_t sigmoid_index;
extern volatile double PWMsigmoidconst;

const double sigmoid_300[] PROGMEM = {
    0,0.01,0.01,0.02,0.03,0.04,0.05,0.07,0.10,0.13,0.18,0.24,0.31,0.39,0.47,0.56,
    0.64,0.72,0.78,0.84,0.88,0.91,0.94,0.95,0.97,0.98,0.98,0.99,0.99,0.99,1
};

const double sigmoid_500[] PROGMEM = {
    0,0.01,0.01,0.01,0.01,0.02,0.02,0.03,0.03,0.04,0.05,0.05,0.07,0.08,0.09,0.11,
    0.13,0.16,0.19,0.22,0.25,0.29,0.33,0.38,0.42,0.47,0.52,0.57,0.62,0.66,0.70,
    0.74,0.78,0.81,0.84,0.86,0.89,0.90,0.92,0.93,0.94,0.95,0.96,0.97,0.97,0.98,
    0.98,0.99,0.99,0.99,1
};

const double sogmoid_500_new[] PROGMEM = {0.011,0.012,0.014,0.016,0.018,0.021,
    0.024,0.027,0.030,0.035,0.039,0.044,0.050,0.057,0.064,0.072,0.082,0.092,0.103,
    0.116,0.130,0.146,0.162,0.181,0.201,0.223,0.246,0.271,0.297,0.325,0.354,0.385,
    0.416,0.448,0.480,0.512,0.545,0.577,0.608,0.639,0.668,0.696,0.723,0.748,0.772,
    0.794,0.815,0.833,0.851,0.866,0.881,0.894,0.906,0.916,0.926,0.934,0.942,0.948,
    0.954,0.960,0.964,0.969,0.972,0.976,0.979,0.981,0.983,0.985,0.987,0.989,0.990
};

const double sigmoid_700[] PROGMEM = {
    0,0.01,0.01,0.01,0.01,0.01,0.02,0.02,0.02,0.02,0.03,0.03,0.03,0.04,0.04,0.05,
    0.06,0.07,0.07,0.08,0.10,0.11,0.12,0.14,0.15,0.17,0.19,0.22,0.24,0.27,0.30,
    0.32,0.36,0.39,0.42,0.45,0.49,0.52,0.56,0.59,0.62,0.66,0.69,0.72,0.74,0.77,
    0.79,0.81,0.83,0.85,0.87,0.88,0.90,0.91,0.92,0.93,0.94,0.95,0.95,0.96,0.96,
    0.97,0.97,0.98,0.98,0.98,0.98,0.99,0.99,0.99,1
};

const double sigmoid_700_new[] PROGMEM = {0.011,0.012,0.014,0.016,0.018,0.021,0.024,
    0.027,0.030,0.035,0.039,0.044,0.050,0.057,0.064,0.072,0.082,0.092,0.103,0.116,
    0.130,0.146,0.162,0.181,0.201,0.223,0.246,0.271,0.297,0.325,0.354,0.385,0.416,
    0.448,0.480,0.512,0.545,0.577,0.608,0.639,0.668,0.696,0.723,0.748,0.772,0.794,
    0.815,0.833,0.851,0.866,0.881,0.894,0.906,0.916,0.926,0.934,0.942,0.948,0.954,
    0.960,0.964,0.969,0.972,0.976,0.979,0.981,0.983,0.985,0.987,0.989,0.990
};

const double sigmoid_900[] PROGMEM = {0.00,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.02,
    0.02,0.02,0.02,0.02,0.03,0.03,0.03,0.04,0.04,0.04,0.05,0.05,0.06,0.06,0.07,0.08,
    0.09,0.09,0.10,0.11,0.13,0.14,0.15,0.17,0.18,0.20,0.21,0.23,0.25,0.27,0.29,0.32,
    0.34,0.36,0.39,0.41,0.44,0.47,0.49,0.52,0.55,0.57,0.60,0.62,0.65,0.67,0.69,0.72,
    0.74,0.76,0.78,0.79,0.81,0.83,0.84,0.85,0.87,0.88,0.89,0.90,0.91,0.92,0.93,0.93,
    0.94,0.94,0.95,0.95,0.96,0.96,0.97,0.97,0.97,0.98,0.98,0.98,0.98,0.98,0.99,0.99,
    0.99,1.00
};

const double sigmoid_900_new[] PROGMEM = {0.011,0.012,0.013,0.015,0.016,0.018,0.020,
    0.022,0.025,0.027,0.030,0.033,0.036,0.040,0.044,0.049,0.054,0.059,0.065,0.072,0.079,
    0.086,0.095,0.104,0.114,0.125,0.136,0.149,0.162,0.176,0.192,0.208,0.225,0.243,0.263,
    0.283,0.304,0.326,0.349,0.372,0.397,0.421,0.446,0.472,0.497,0.522,0.548,0.573,0.598,
    0.622,0.646,0.669,0.691,0.712,0.733,0.752,0.771,0.788,0.805,0.820,0.835,0.848,0.861,
    0.873,0.884,0.894,0.903,0.912,0.920,0.927,0.933,0.939,0.945,0.950,0.955,0.959,0.963,
    0.966,0.969,0.972,0.975,0.977,0.979,0.981,0.983,0.985,0.986,0.988,0.989,0.990,0.991
};

const double sigmoid_1200[] PROGMEM ={0.003,0.003,0.003,0.004,0.004,0.005,0.005,0.005,
    0.006,0.006,0.007,0.008,0.009,0.009,0.010,0.011,0.012,0.013,0.015,0.016,0.017,0.019,0.021,
    0.023,0.025,0.027,0.030,0.033,0.036,0.039,0.042,0.046,0.050,0.055,0.060,0.065,0.071,0.077,
    0.084,0.091,0.099,0.107,0.116,0.126,0.136,0.147,0.159,0.172,0.185,0.199,0.214,0.230,0.246,
    0.264,0.282,0.300,0.320,0.340,0.361,0.382,0.404,0.426,0.448,0.471,0.494,0.516,0.539,0.561,
    0.584,0.606,0.627,0.648,0.669,0.688,0.708,0.726,0.744,0.761,0.777,0.792,0.807,0.821,0.834,
    0.846,0.857,0.868,0.878,0.888,0.896,0.905,0.912,0.919,0.926,0.932,0.937,0.942,0.947,0.952,
    0.956,0.959,0.963,0.966,0.969,0.971,0.974,0.976,0.978,0.980,0.982,0.983,0.985,0.986,0.987,
    0.988,0.989,0.990,0.991,0.992,0.993,0.993,0.994
};

const double sigmoid_1500[] PROGMEM ={0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,
    0.01,0.01,0.01,0.01,0.01,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.03,0.03,0.03,0.03,
    0.03,0.03,0.04,0.04,0.04,0.04,0.05,0.05,0.05,0.06,0.06,0.06,0.07,0.07,0.08,0.08,0.08,
    0.09,0.10,0.10,0.11,0.11,0.12,0.13,0.13,0.14,0.15,0.16,0.16,0.17,0.18,0.19,0.20,0.21,
    0.22,0.23,0.25,0.26,0.27,0.28,0.29,0.31,0.32,0.34,0.35,0.36,0.38,0.39,0.41,0.42,0.44,
    0.45,0.47,0.49,0.50,0.52,0.53,0.55,0.56,0.58,0.59,0.61,0.62,0.64,0.65,0.67,0.68,0.69,
    0.71,0.72,0.73,0.74,0.76,0.77,0.78,0.79,0.80,0.81,0.82,0.83,0.84,0.85,0.85,0.86,0.87,
    0.88,0.88,0.89,0.89,0.90,0.91,0.91,0.92,0.92,0.93,0.93,0.93,0.94,0.94,0.94,0.95,0.95,
    0.95,0.96,0.96,0.96,0.96,0.97,0.97,0.97,0.97,0.97,0.97,0.98,0.98,0.98,0.98,0.98,0.98,
    0.98,0.98,0.99,0.99,0.99,0.99
};

const double sigmoid_500_new[] PROGMEM ={0.001,0.002,0.002,0.003,0.004,0.005,0.007,0.009,
    0.011,0.014,0.018,0.023,0.030,0.038,0.048,0.061,0.077,0.097,0.122,0.152,0.187,0.228,0.276,
    0.329,0.387,0.448,0.510,0.573,0.633,0.690,0.741,0.786,0.825,0.859,0.887,0.910,0.928,0.943,
    0.955,0.965,0.973,0.979,0.983,0.987,0.990,0.992,0.994,0.995,0.996,0.997,0.998
};

const double sigmoid_05[] PROGMEM = {
    0.000,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.003,0.003,0.003,0.003,0.003,0.003,0.004,0.004,0.004,0.004,0.004,
    0.004,0.005,0.005,0.005,0.005,0.006,0.006,0.006,0.007,0.007,0.007,0.008,0.008,0.009,0.009,
    0.009,0.010,0.010,0.011,0.012,0.012,0.013,0.013,0.014,0.015,0.016,0.016,0.017,0.018,0.019,
    0.020,0.021,0.022,0.023,0.024,0.025,0.027,0.028,0.029,0.031,0.032,0.034,0.036,0.037,0.039,
    0.041,0.043,0.045,0.047,0.050,0.052,0.055,0.057,0.060,0.063,0.066,0.069,0.072,0.076,0.079,
    0.083,0.087,0.091,0.095,0.100,0.104,0.109,0.114,0.119,0.125,0.130,0.136,0.142,0.148,0.154,
    0.161,0.168,0.175,0.182,0.190,0.198,0.206,0.214,0.223,0.231,0.240,0.250,0.259,0.269,0.279,
    0.289,0.299,0.310,0.321,0.332,0.343,0.354,0.366,0.378,0.389,0.401,0.413,0.426,0.438,0.450,
    0.463,0.475,0.488,0.500,0.512,0.525,0.537,0.550,0.562,0.574,0.587,0.599,0.611,0.622,0.634,
    0.646,0.657,0.668,0.679,0.690,0.701,0.711,0.721,0.731,0.741,0.750,0.760,0.769,0.777,0.786,
    0.794,0.802,0.810,0.818,0.825,0.832,0.839,0.846,0.852,0.858,0.864,0.870,0.875,0.881,0.886,
    0.891,0.896,0.900,0.905,0.909,0.913,0.917,0.921,0.924,0.928,0.931,0.934,0.937,0.940,0.943,
    0.945,0.948,0.950,0.953,0.955,0.957,0.959,0.961,0.963,0.964,0.966,0.968,0.969,0.971,0.972,
    0.973,0.975,0.976,0.977,0.978,0.979,0.980,0.981,0.982,0.983,0.984,0.984,0.985,0.986,0.987,
    0.987,0.988,0.988,0.989,0.990,0.990,0.991,0.991,0.991,0.992,0.992,0.993,0.993,0.993,0.994,
    0.994,0.994,0.995,0.995,0.995,0.995,0.996,0.996,0.996,0.996,0.996,0.996,0.997,0.997,0.997,
    0.997,0.997,0.997,0.998,0.998,0.998,0.998,0.998,0.998,0.998,0.998,0.998,0.998,0.998,0.999,
    0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,0.999,
    0.999,0.999,0.999,0.999,0.999,0.999,1.000
};

const double sigmoid_1[] PROGMEM={
    0.000,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.002,0.002,
    0.002,0.002,0.002,0.003,0.003,0.003,0.004,0.004,0.004,0.005,0.005,0.006,0.007,0.007,0.008,
    0.009,0.010,0.011,0.012,0.013,0.015,0.016,0.018,0.020,0.022,0.024,0.027,0.029,0.032,0.036,
    0.039,0.043,0.047,0.052,0.057,0.063,0.069,0.076,0.083,0.091,0.100,0.109,0.119,0.130,0.142,
    0.154,0.168,0.182,0.198,0.214,0.231,0.250,0.269,0.289,0.310,0.332,0.354,0.378,0.401,0.426,
    0.450,0.475,0.500,0.525,0.550,0.574,0.599,0.622,0.646,0.668,0.690,0.711,0.731,0.750,0.769,
    0.786,0.802,0.818,0.832,0.846,0.858,0.870,0.881,0.891,0.900,0.909,0.917,0.924,0.931,0.937,
    0.943,0.948,0.953,0.957,0.961,0.964,0.968,0.971,0.973,0.976,0.978,0.980,0.982,0.984,0.985,
    0.987,0.988,0.989,0.990,0.991,0.992,0.993,0.993,0.994,0.995,0.995,0.996,0.996,0.996,0.997,
    0.997,0.997,0.998,0.998,0.998,0.998,0.998,0.998,0.999,0.999,0.999,0.999,0.999,0.999,0.999,
    0.999,0.999,0.999,0.999,1.000
};

const double sigmoid_15[] PROGMEM={
    0.000,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.002,0.002,0.002,0.003,0.003,0.004,
    0.004,0.005,0.006,0.007,0.008,0.009,0.011,0.013,0.015,0.017,0.020,0.023,0.027,0.031,0.036,
    0.041,0.047,0.055,0.063,0.072,0.083,0.095,0.109,0.125,0.142,0.161,0.182,0.206,0.231,0.259,
    0.289,0.321,0.354,0.389,0.426,0.463,0.500,0.537,0.574,0.611,0.646,0.679,0.711,0.741,0.769,
    0.794,0.818,0.839,0.858,0.875,0.891,0.905,0.917,0.928,0.937,0.945,0.953,0.959,0.964,0.969,
    0.973,0.977,0.980,0.983,0.985,0.987,0.989,0.991,0.992,0.993,0.994,0.995,0.996,0.996,0.997,
    0.997,0.998,0.998,0.998,0.998,0.999,0.999,0.999,0.999,0.999,0.999,0.999,1.000
};

const double sigmoid_2[] PROGMEM={
    0.000,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.002,0.002,0.003,0.004,0.004,0.005,0.007,
    0.008,0.010,0.012,0.015,0.018,0.022,0.027,0.032,0.039,0.047,0.057,0.069,0.083,0.100,0.119,
    0.142,0.168,0.198,0.231,0.269,0.310,0.354,0.401,0.450,0.500,0.550,0.599,0.646,0.690,0.731,
    0.769,0.802,0.832,0.858,0.881,0.900,0.917,0.931,0.943,0.953,0.961,0.968,0.973,0.978,0.982,
    0.985,0.988,0.990,0.992,0.993,0.995,0.996,0.996,0.997,0.998,0.998,0.998,0.999,0.999,0.999,
    0.999,0.999,0.999,1.000
};